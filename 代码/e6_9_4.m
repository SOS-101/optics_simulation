n=1.000;nD1=1.51470;nD3=1.67270;
nF1=1.52067;nF3=1.68749;
nC1=1.51218;nC3=1.66662;
r1=61.857189;r2=-43.831719;r3=-128.831547;
d1=1.9433;d2=1.1;hm=20;
%定义主要参数
h1=linspace(0.01,hm,1000);
U1=0;
u1=0;
%D光近轴
%D光近轴在第一镜面成像参数
i1=h1./r1;
i11=n.*i1./nD1;
u11=u1+i1-i11;
l11=(i11.*r1)./u11+r1
%D光近轴在第二镜面成像参数
l2=l11-d1;
i2=(l2-r2).*u11./r2;
i21=nD1.*i2./nD3;
u21=u11+i2-i21;
l21=r2+r2.*i21./u21
%D光近轴在第三镜面成像参数
l3=l21-d2;
i3=(l3-r3).*u21./r3;
i31=nD3.*i3./n;
u31=u21+i3-i31;
l31=r3+r3.*i31./u31
%D光远轴
%计算初值为L1=inf，U1=0，sinI1=h1/r1；
% D光远轴在第一镜面成像参数
I1=asin(h1./r1);
I11=asin(n.*sin(I1)./nD1)
U11=0+I1-I11;
L11=r1+(r1.*sin(I11)./sin(U11));
%D光远轴在第二镜面成像参数
L2=L11-d1;
U2=U11;
I2=asin((L2-r2).*sin(U2)./r2);
I21=asin(nD1.*sin(I2)./nD3);
 U21=U2+I2-I21;
L21=r2+(r2.*sin(I21)./sin(U21));
%D光远轴在第三镜面成像参数
L3=L21-d2;
U3=U21;
I3=asin((L3-r3).*sin(U3)./r3);
I31=asin(nD3.*sin(I3)./n);
U31=U3+I3-I31;
L31=r3+(r3.*sin(I31)./sin(U31));
%理想值减实际值得球差
LC=l31-L31
plot(LC,h1/hm,'-');
 title('D光F光C光球差曲线')
holdon
%F光近轴
%F光近轴在第一镜面成像参数
i1=h1./r1;
i11=n.*i1./nF1;
u11=u1+i1-i11;
l11=((i11.*r1)./u11)+r1;
%F光近轴在第二镜面成像参数
l2=l11-d1;
i2=(l2-r2).*u11./r2;
i21=nF1.*i2./nF3;
u21=u11+i2-i21;
l21=r2+r2.*i21./u21
%F光近轴在第三镜面成像参数
l3=l21-d2;
i3=(l3-r3).*u21./r3;
i31=nF3.*i3./n;
u31=u21+i3-i31;
l31=r3+r3.*i31./u31
%F光远轴
%计算初值为L1=inf，U1=0，sinI1=h1/r1；
% F光远轴在第一镜面成像参数
I1=asin(h1./r1);
I11=asin(n.*sin(I1)./nF1)
U11=U1+I1-I11;
L11=r1+(r1.*sin(I11)./sin(U11));
%F光远轴在第二镜面成像参数
L2=L11-d1;
U2=U11;
I2=asin((L2-r2).*sin(U2)./r2);
I21=asin(nF1.*sin(I2)./nF3);
U21=U2+I2-I21;
L21=r2+(r2.*sin(I21))./sin(U21);
%F光远轴在第三镜面成像参数
L3=L21-d2;
U3=U21;
I3=asin((L3-r3).*sin(U3)./r3);
I31=asin(nF3.*sin(I3)./n);
U31=U3+I3-I31;
L31=r3+(r3.*sin(I31)./sin(U31));
%理想值减实际值得球差
LC=l31-L31
plot(LC,h1/hm,'--');
holdon
plot(0,[0:0.01:hm]/hm,'k')
%C光近轴
%C光近轴在第一镜面成像参数
i1=h1./r1;
i11=n.*i1./nC1;
u11=u1+i1-i11;
l11=((i11.*r1)./u11)+r1;
%C光近轴在第二镜面成像参数
l2=l11-d1;
i2=(l2-r2).*u11./r2;
i21=nC1.*i2./nC3;
u21=u11+i2-i21;
l21=r2+(r2.*i21./u21);
%C光近轴在第三镜面成像参数
l3=l21-d2;
i3=(l3-r3).*u21./r3;
i31=nC3.*i3./n;
u31=u21+i3-i31;
l31=r3+(r3.*i31./u31);
%C光远轴
%计算初值为L1=inf，U1=0，sinI1=h1/r1；
%C光远轴在第一镜面成像参数
I1=asin(h1./r1);
I11=asin(n.*sin(I1)./nC1)
U11=U1+I1-I11;
L11=r1+(r1.*sin(I11)./sin(U11));
%C光远轴在第二镜面成像参数
L2=L11-d1;
U2=U11;
I2=asin((L2-r2).*sin(U2)./r2);
I21=asin(nC1.*sin(I2)./nC3);
U21=U2+I2-I21;
L21=r2+(r2.*sin(I21)./sin(U21));
%C光远轴在第三镜面成像参数
L3=L21-d2;
U3=U21;
I3=asin((L3-r3).*sin(U3)./r3);
I31=asin(nC3.*sin(I3)./n);
U31=U3+I3-I31;
L31=r3+(r3.*sin(I31)./sin(U31));
LC=l31-L31
plot(LC,h1/hm,'-.');
plot(0,[0:0.01:hm]/hm,'k');legend('D光球差曲线','F光球差曲线','C光球差曲线');
